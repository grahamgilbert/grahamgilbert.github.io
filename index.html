<!DOCTYPE html>
<html lang="en-us">

  <head>
  <script type="text/javascript">
    var host = "grahamgilbert.com";
    if ((host == window.location.host) && (window.location.protocol != "https:"))
        window.location.protocol = "https";
  </script>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      graham gilbert &middot; Mac administration and assorted nerdity
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <!--link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico"-->

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
  <link href='/stylesheets/all-b18cc7d6d5710987503b687ec013f838.css' media='all' rel='stylesheet' type='text/css'>
  <link type="application/atom+xml" rel="alternate" href="https://grahamgilbert.com//atom.xml" title="graham gilbert" />
  <style>
  .clear{
    clear:both
  }
  .float-left {
    float:left;
    padding-right:25px;
    padding-bottom:25px;
  }

  .float-right {
    float:right;
    padding-left:25px;
    padding-bottom:25px;
  }
  </style>
</head>

  <body class="theme-base-0d">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          graham gilbert
        </a>
      </h1>
      <p class="lead">A Mac admin, automating the hell out of things.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
      
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/projects/">Projects</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/talks/">Talks</a>
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
      </nav>
      <p>

      <a href="https://twitter.com/grahamgilbert"><img style="display:inline;" src="/images/social/twitter.png" /></a> <a href="https://github.com/grahamgilbert"><img style="display:inline;" src="/images/social/github.png" /></a> <a href="https://www.linkedin.com/in/grahamgilbert"><img style="display:inline;" src="/images/social/linkedin.png" /></a>
      </p>

    <p>
      <small>The opinions on this site are my own, and are not necessarily shared by my employer.</small>
    </p>

  </div>
</div>

    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2017/01/11/imagr-with-target-disk-mode/">
        Imagr with target disk mode
      </a>
    </h1>

    <span class="post-date">11 Jan 2017</span>


    
    <p><a href="https://github.com/grahamgilbert/imagr">Imagr</a> is a great tool when you’re wanting to deploy machines quickly in your office. But sometimes you will want to deploy machines when you’re in a smaller remote site, or a site where security concerns mean you can’t have servers. Imagr is flexible enough to handle this, and with a little creativity, we can deploy at these sites as easily as we can at our offices with NetBoot.</p>

<h2 id="setup">Setup</h2>

<p>The first thing you are going to want to do it get your Imagr repo onto your own machine. I would recommend having your repo in a central repository - <a href="https://www.afp548.com/2014/11/24/introduction-to-git-fat-for-munki/">git fat</a> works well, so does putting everything on an <a href="https://aws.amazon.com/s3/">S3 bucket</a> and using the <a href="https://aws.amazon.com/cli/">aws cli tools</a> to sync it down. We use an S3 bucket, as we can ship read only credentials to the machines that are performing the imaging. This guide will assume you are using S3, but you can substitute that aspect for whichever method you wish to sync your files. 
  <p><a href="/blog/2017/01/11/imagr-with-target-disk-mode/">Read more →</a></p>
  
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2016/12/15/enable-sip-with-munki/">
        Enable SIP with Munki
      </a>
    </h1>

    <span class="post-date">15 Dec 2016</span>


    
    <p>When 10.12.2 hit this week, it introduced an awesome new feature - the <a href="https://onemoreadmin.wordpress.com/2016/12/13/system-integrity-protection-sip-changes-in-macos-sierra-10-12-2/">ability to enable SIP</a> without having to be booted into a Recovery like environment (either Recovery HD or a NetInstall). Unfortunately it merely enables SIP on the next reboot.</p>

<p>Fortunately, Munki is pretty good at telling users when they need to reboot, so I wrote the following pkgsinfo file that will check if SIP is enabled, and if it isn’t, will enable it and reboot (fortunately it’s quite a bit easier to do this that it is with <a href="https://babodee.wordpress.com/2016/12/15/ensuring-sip-is-enabled/">other tools</a>. I’ve targeted this update at 10.12.0, because, well, if they’re not updating, I’d like them to. And it’s called ‘Critical Security Update’ so they may actually install it. If you really want them to install it, you can set a <code>force_install_after_date</code> and set it to the past, which will give your users a hour to install it before their machine goes byebye. 
  <p><a href="/blog/2016/12/15/enable-sip-with-munki/">Read more →</a></p>
  
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2016/12/07/sal-an-overview/">
        Sal: an overview
      </a>
    </h1>

    <span class="post-date">07 Dec 2016</span>


    
    <p>It’s been a long time since I wrote about Sal here (nearly <a href="/blog/2014/01/17/sal-the-munki-puppet/">three years</a>), so with the release of Sal 3.0, it’s time to take another look at it.</p>

<h2 id="what-is-sal">What is Sal?</h2>

<p>Sal is a reporting tool for macOS clients that helps you visualise what your clients are up to. It is primarily a reporting tool for <a href="https://github.com/munki/munki">Munki</a>, but it can also ingest data from <a href="https://docs.puppet.com/facter/latest/">Facter</a> (whether you are using Puppet to manage your Macs or not).</p>

<p>It has the concept of business units, so if you wish to separate your clients out (for example, if you wish to give access to some machines to a sub organisation’s IT etc) you are able to do so.</p>

<p>That’s the 10000 feet overview, let’s take a look at some of it’s functionality in more detail.</p>

<h2 id="the-dashboard">The dashboard</h2>

<p><img class="center" src="/images/posts/2016-12-07/01-Dashboard.png" /></p>

<p>The first thing you see when you log into Sal is the dashboard. This is where you can get access to a quick overview of your fleet. Each graph, chart, set of buttons is a plugin - this means that each one can be re-ordered and removed - you can even make your own if you need to (more on that another time). Most plugins are clickable - click on the relevent part to show a list of machines it is referring to - and if the plugin supports showing the list (and all of the built in ones do), you can export the list to CSV (since all managers love spreadsheets, right?).
  <p><a href="/blog/2016/12/07/sal-an-overview/">Read more →</a></p>
  
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2016/12/06/sal-3-0/">
        Sal 3.0
      </a>
    </h1>

    <span class="post-date">06 Dec 2016</span>


    
  <p><a href="https://github.com/salopensource/sal/releases/tag/3.0.0">Sal 3.0</a> is a massive upgrade on Sal 2.7, so massive thanks to everyone who has contributed code and bug reports. In particular, big thanks go out to <a href="https://github.com/sheagcraig">@sheagcraig</a>  for his work on the completely rewritten application inventory features.</p>

<h2 id="whats-new-in-sal-30">What’s new in Sal 3.0?</h2>

<h3 id="inventory">Inventory</h3>

<p>Sal’s application inventory tracking has been completely re-written (thanks again Shea), and is much more useful, allowing for greater detail on what is installed, and where across your fleet.</p>

<h3 id="search">Search</h3>

<p>We have migrated the basic search from using an external application that relied on building caches (so doubling the size of your database), to just querying the database directly.</p>

<p>The advanced search is completely new - it allows you to build up complex queries that would previously require you to build a plugin. These queries can also be saved so they can be shared with the rest of your team.</p>

<h3 id="plugins">Plugins</h3>

<p>Your plugins can now process data server side during checkin. Perhaps you want to update Sal with information from your Inventory tool, or call out to a web service. Documentation can be found <a href="https://github.com/salopensource/sal/wiki/Additional-processing-of-data-in-Pugins">over here</a>.</p>

<h3 id="security">Security</h3>

<p>Sal scripts version <a href="https://github.com/salopensource/sal-scripts/releases/tag/2.0.0">2.0.0</a> now uses basic http authentication by default (<a href="https://github.com/salopensource/sal/wiki/Client-configuration">using the key set in preferences</a>) on any endpoint that it retrieves data from (external scripts etc). This means that any potentially sensitive data you may have in your client side scripts is now protected. This can be <a href="https://github.com/salopensource/sal/wiki/Settings#basic-authentication-on-http-endpoints">disabled if desired</a> - not recommended!.</p>

<h3 id="performance">Performance</h3>

<p>If you have a lot of plugins enabled with client side scripts to download, you will be getting a lot of requests to your server. There is now a script available that will build a package containing all the external scripts enabled on your Sal install (or just download the files so they can be deployed with something like Puppet or Chef), and after setting the <a href="https://github.com/salopensource/sal/wiki/Client-configuration">preference</a>, the client will use these in preference to downloading them again.</p>

<p>If you are running Facter, you may be shipping duplicate data that Sal already collects - you are now able to specify facts that should not be sent to the server (enabling you to set different facts to ignore per client) or <a href="https://github.com/salopensource/sal/wiki/Settings#ignore_facts">set it on the server to configure it globally</a>.</p>

<p>Finally, every single transaction with the database has been optimised. A usual run from a client that has Facter installed with 50 facts has been reduced from 70+ calls to the database to less than 10 (Postgres only, sorry SQLite and MySQL users).</p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/blog/2016/11/04/macad-uk-2017/">
        MacAD.UK 2017
      </a>
    </h1>

    <span class="post-date">04 Nov 2016</span>


    
  <p>I’m delighted to announce that the lovely people at Amsys have asked me to return to speak at <a href="http://www.macad.uk/">MacAD.UK 2017</a> for it’s second year. This year I will be talking about <a href="http://www.macad.uk/speaker/speaker-graham-gilbert/">Airbnb’s transition from a commercial macOS management platform to an entirely open source stack</a> - <em>“Something something commercial, something something open source”</em>.</p>

<p>See you all in February!</p>


  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>

    </div>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27233739-1', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
